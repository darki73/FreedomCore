var Embed = Embed || {};
(function(o) {
	var g = false;
	var i = false;
	var f;
	var k = function(p) {
		if (!p) {
			return false;
		}
		var q = f(p);
		if (!q) {
			q = h(p);
		}
		if (!q) {
			return false;
		}
		return j(q);
	};
	var l = function(p) {
		return document.evaluate("//a[contains(@href,'" + p + "')]", document, null,
			XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
	};
	var d = function(p) {
		var r = document.getElementsByTagName("a");
		for (var q = 0; q < r.length; q++) {
			if (j(r[q]).href == p) {
				return r[q];
			}
		}
		return false;
	};
	var h = function(p) {
		var r = document.getElementsByTagName("a");
		for (var q = 0; q < r.length; q++) {
			if (r[q].href == p) {
				return r[q];
			}
		}
		return false;
	};
	var m = function(q) {
		var p = document.querySelector("a[href='" + q + "']");
		if (p) {
			return p;
		}
		return false;
	};
	var e = function(p, q) {
		var r = k(p);
		if (r) {
			if (r[q]) {
				return r[q];
			}
		}
		return false;
	};
	var j = function(t) {
		var s = {};
		var q = t.attributes || false;
		if (!q || !q.length) {
			return false;
		}
		for (var p, r = 0; r < q.length; r++) {
			p = q.item(r);
			s[p.nodeName] = p.nodeValue;
		}
		return s;
	};
	var c = function(p) {
		if (g && "function" === typeof g) {
			var q = p.target;
			do {
				if (q.tagName && "a" === q.tagName.toLowerCase()) {
					if (g(q)) {
						p.preventDefault();
					}
					return;
				}
			} while (q = q.parentNode);
		}
	};
	var b = function(p) {
		a();
		if ("function" === typeof p) {
			g = p;
			if (!i) {
				document.addEventListener("click", c, false);
				i = true;
			}
		}
	};
	var a = function() {
		g = false;
	};
	var n = function() {
		if (document.querySelector) {
			f = m;
		} else {
			if (document.evaluate) {
				f = l;
			} else {
				f = d;
			}
		}
		o.getAttributesForHref = k;
		o.getAttributeValueForHref = e;
		o.setInterceptHandler = b;
		o.clearInterceptHandler = a;
		o.plumbing = {
			findAnchorByTraversal: function(p) {
				return d(p);
			},
			findAbsoluteAnchorByTraversal: function(p) {
				return h(p);
			},
			findAnchorByHrefXPath: function(p) {
				return l(p);
			},
			findAnchorByQuerySelector: function(p) {
				return m(p);
			},
			getElementAttributes: function(p) {
				return j(p);
			},
			getInterceptHandlerFunction: function() {
				return g;
			},
			getFindAnchorByQuerySelectorFunction: function() {
				return m;
			},
			getSelectedSearchFunction: function() {
				return f;
			}
		};
	};
	if ("complete" === document.readyState || "interactive" === document.readyState) {
		n();
	} else {
		document.addEventListener("DOMContentLoaded", n, false);
	}
})(Embed);